{{$factory_conf := "/factory/devel/ssh"}}
{{$common_conf := "/common/devel/ssh"}}
{{$local_conf := "/local/devel/ssh"}}

{{$source := include "/lib/systemd/system/sshd.socket"}}

{{if (ne $source "")}}
     #
     # generated by confd
     # do not edit
     #
     {{if or (exists $factory_conf) (exists $common_conf) (exists $local_conf)}}
         {{$factory_defs := getv $factory_conf "{}"}}
         {{$common_defs := getv $common_conf "{}"}}
         {{$local_defs := getv $local_conf "{}"}}

         {{$ssh := merge $factory_defs $common_defs $local_defs}}

         {{$port := integerValue $ssh.Port 22}}
     	 {{regReplace $source "ListenStream=([0-9]+)" (printf "ListenStream=%v" $port)}}
    {{else}}
	 {{$source}}
    {{end}}
{{end}}
